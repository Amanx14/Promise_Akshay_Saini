<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Promise</title>

    <style>
        body {
            background-color: #212121;
            color: white;
        }
    </style>
</head>

<body>
    <h1>Akshay is teaching us Promise</h1>

    <!-- <script>
        const cart = ["kurta", "pajama", "trouser"];
        const promise = createOrder(cart);

        promise
            .then(function (orderId) {
                console.log(orderId);
                return orderId;
            })
            .then(function (orderId) {
                return proceedToPayment(orderId);
            })
            .then(function(paymentInfo) {
                console.log(paymentInfo);
            })
            .catch(function (err) {
                console.log(err.message);
            })
            .then (function() {
                console.log("No matter whatever happens I will always be called.");
            }) 

        // Producer Code

        function createOrder(cart) {
            const pr = new Promise(function (resolve, reject) {
                if (isValidateCart(cart) == false) {
                    const err = new Error("Cart is not validated");
                    reject(err);
                }

                //Logic for create order
                const orderId = "12345";

                if (orderId) {
                    resolve(orderId);
                }

            });


            return pr;
        }

        function proceedToPayment(orderId) {
            return new Promise(function (resolve, reject) {
                resolve("Payment Successful");
            })
        }

        function isValidateCart(cart) {
            return true;
        }
    </script> -->

    <!-- Promise Homework -->

    <!-- <script>
        const cart = ["TV", "fridge", "AC"];
        const promise = createOrder(cart);

        promise
            .then((orderId) => {
                console.log(orderId);
                return orderId;
            })
            .then((orderId)=> {
                return proceedToPayment(orderId);
            })
            .then((paymentInfo)=> {
                return showOrderSummary(paymentInfo);
            })
            .then((orderInfo)=> {
                return updateWallet(orderInfo);
            })
            .then((UpdatedBalance)=> {
                console.log(UpdatedBalance);
            }) 
            .catch((error) => {
                console.log(error.message)
            })

        function createOrder(cart) {

            const promise = new Promise((resolve, reject) => {
                const isValidateCart= true;
                const orderId = 1234;

                if(isValidateCart && orderId) {
                    resolve(orderId);
                }

                if(isValidateCart == false) {
                    const error = new Error("Cart is not valid.");
                    reject(error);
                }

                
            })

            return promise;
        }

        function proceedToPayment(orderId) {
            return new Promise((resolve, reject)=> {
                resolve("Payment Successful")
            })
        }

        function showOrderSummary(paymentInfo) {
            return new Promise((resolve, reject)=> {
                resolve("Order Summary")
            })
        }

        function updateWallet(orderInfo) {
            return "You have this amount left $$";
        }

    </script> -->

    <!-- <script>
        // Async => Asynchronous function always return a promise agar promise ke alawe koi or value hai toh usko promise me wrap kar ke return kar dega
        
        const p = new Promise(function(resolve, reject) {
            resolve("Promise Resolved Value");
        }); 

        async function getData() {
            return p;
        }

        const data = getData();
        
        data.then((res)=> {
            console.log(res);
        })
 
    </script> -->

    <!-- <script>
        // Asysnc and Await combo used to handle promise

       // Creating a promise

        const promise = new Promise((resolve, reject) => {
            setTimeout(function() {
                resolve("Promise resolved value");
            }, 5000);
        })

        // How promise was handled before async and await 

        /* function getData() {
            // JS Engine will not wait for promise to be resolved
            promise.then((res) => {
                console.log(res);
            })
            console.log("Namaste Javascript");
        } 

        getData(); */

        // Handling promise using async and await

        async function handlePromise() {
            // JS Engine was waiting for the promise to be resolved
            const data = await promise;
            console.log(data);
            console.log("Namaste Javascript");
        }

        handlePromise();

    </script> -->

    <!-- <script>
        // async await callstack suspend examples

        const promise1 = new Promise(function(resolve, reject) {
            setTimeout(function(){
                resolve("Resolving first promise data.");
            }, 20000)
        })

        const promise2 = new Promise(function(resolve, reject) {
            setTimeout(function(){
                resolve("Resolving second promise data.");
            }, 40000)
        })

        async function handlePromise() {
            console.log('Hello JS');

            const data1 = await promise1;
            console.log(data1);
            console.log("Namastey Javascript 1");

            const data2 = await promise2;
            console.log(data2);
            console.log("Namastey Javascript 2");
        }

        handlePromise();
    </script> -->

    <script>
        // Real world examples API calling

        const API_URL = "https://api.github.com/users/amanx14";

        // API Calling Using promise 
        // function handleAPIusingPromise() {
        //     const response = fetch(API_URL);

        //     response
        //         .then(function (res) {
        //             const data = res.json();
        //             console.log(data);
        //             return data;
        //         })
        //         .then(function (val) {
        //             console.log(val);
        //         })

        //     // fetch().then(res => res.json()).then(res => console.log(res));
        // }

        // handleAPIusingPromise();

        // Handling API using async and await
        async function handleAPI() {
            try {
                const response = await fetch(API_URL);
                const json = await response.json();
                console.log(json);
            }
            catch(err) {
                console.log(err);
            }
        }

        handleAPI();
    </script>
</body>

</html>